## Что это такое?

Простейший движок для создания коллекции карт для настольных ролевых игр. Для
отображения карт используется движок [Leaflet](http://leafletjs.com/).

Карты описываются в json-файлах и группируются по проектам.

## Как поставить движок на свой сервер?

Если вам нужно однократно развернуть движок, вы можете воспользоваться ручной установкой. Все необходимые файлы уже
включены в релиз, их лишь нужно немного подредактировать.

### Ручная установка

1. Скачиваем последний релиз здесь: `https://github.com/KarelWintersky/kwLeafletMaps/releases`
2. Распаковываем на локалхосте
3. Задаем корректные значения константам в файле `./backend/config.php`
  - `LFME_ROOT_PATH` -- путь к корню проекта (к файлу .htaccess и index.php); 
  - `LFME_TEMPLATES_PATH` -- путь к шаблонам (обычно `$` + `LFME_ROOT_PATH` + `/templates`);
  - `LFME_INDEX_TITLE` -- Значение тега title для шаблона `index.html` (может быть определено и в самом шаблоне).
  - `LFME_VIEWPORT_WIDTH` -- Ширина области leaflet-карты по умолчанию; 
  - `LFME_VIEWPORT_HEIGHT` -- Высота области leaflet-карты по умолчанию;
4. Вносим изменения в файл `.htaccess`: 
`RewriteBase XXX`
Устанавливаем значение, равное `LFME_ROOT_PATH`;
5. Создаем конфигурационные файлы проектов;
6. Заливаем на сервер файлы движка и карты (в каталоге `storage`) 
7. Готово?!

### Полуавтоматическая (раздельная) установка

Полуавтоматическая установка полезна, вы хотите заливать карты и файлы конфигурации на сервер лёгким движением руки (точнее короткой командой в терминале).

Правда в этом случае придётся совершить больше телодвижений по установке.

Подробности: [Раздельная установка](.deploy/README-DEPLOY.md)

## Коллекции и карты

Следует понимать, что карты группируются по коллекциям и на каждую создается отдельный файл
конфигурации. Все данные (и файлы конфигурации, и сами файлы карт) хранятся в каталоге `./storage`.

1. создаем и заливаем на сервер файл конфигурации (его можно сделать на основе шаблона `gallery.template`). Для
каждой коллекции нужен свой файл конфигурации;
2. Заливаем в каталог `./storage/projectalias` файлы карт и прописываем пути в соответствующем `json`-файле; 
3. Движок анализирует файлы конфигурации и строит список коллекций или карт в коллекциях автоматически.

## Конфигурационный файл проекта

смотрите [README-CONFIG.md](README-CONFIG.md)

## Полезные рецепты

### Встраивание карт на страницу:

Я встраиваю карты в tiddlywiki так:
```
<html>
<iframe src="http://rpg.wintersky.ru/leafletmaps/confederation/confmap?width=700&height=500" width="100%" height="600" frameborder="0"/>
</html>
```

Здесь мы указываем `width` и `height` отображаемой области и эти настройки перекроют
параметры отображения, заданные в конфигурационном файле для проекта или карты.


## Демо

[Leafletmaps at RPG@KW](http://rpg.wintersky.ru/leafletmaps/)

Current version: 0.3


## Сделай доброе дело - и кинь его в пропасть

Можно сказать спасибо, можно подарить печеньку. Но если очень хочется поучить меня
жить - лучше помогите материально:

- `4276 5500 1905 6525` VISA (Сбербанк)
- `41001445086806` (Яндекс.Деньги)
